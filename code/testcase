import { TMXWeb, TMX } from './tmxplugin';
import { registerPlugin } from '@capacitor/core';

jest.mock('@capacitor/core', () => ({
  registerPlugin: jest.fn(),
  WebPlugin: class {
    constructor() {}
  },
}));

describe('TMXWeb Plugin', () => {
  let tmxWeb: TMXWeb;

  beforeEach(() => {
    tmxWeb = new TMXWeb();
  });

  it('should throw "Method not implemented" when profileDevice is called', async () => {
    await expect(tmxWeb.profileDevice({ tmxSessionId: '123' })).rejects.toThrow('Method not implemented.');
  });

  it('should register TMX plugin using registerPlugin', () => {
    expect(registerPlugin).toHaveBeenCalledWith('TMX', { web: expect.any(Function) });
  });

  it('should create a TMXWeb instance when calling the web function', () => {
    const pluginConfig = registerPlugin.mock.calls[0][1];
    const webInstance = pluginConfig.web();
    expect(webInstance).toBeInstanceOf(TMXWeb);
  });
});
